<html>

<head>

  <title>A Multiplayer Game</title>

  <!--Google Icon & Font-->
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css?family=Indie+Flower" rel="stylesheet">

  <!-- Materialize -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/css/materialize.min.css">

  <!--Let browser know website is optimized for mobile-->
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link rel="stylesheet" type="text/css" href="/css/style.css">

  <script src="/socket.io/socket.io.js"></script>

  <script src="https://github.com/typicaljoe/taffydb/raw/master/taffy.js"></script>

</head>

<body>

  <main class="test purple lighten-4">
    <div class="row">
      <form>
      <div class="col s12">
        
          <div class="input-field col s12">
              <input id="nickname" type="text" pattern="[A-Za-z0-9]{3,}" class="validate" required=""
                aria-required="true">
              <label for="text">Your nickname</label>
              <span class="helper-text" data-error="3 characters minimum. Only letters and/or numbers"
                data-success=""></span>
            </div>
          </div>
          <div class="col s12 l6 white">
              <h5 class="purple-text text-darken-1 center-align">Join a game</h5>
 
          <div class="input-field col s12">
            <input id="room" type="text" pattern="[0-9]{6}" class="validate" required="" aria-required="true">
            <label for="text">The room number</label>
            <span class="helper-text" data-error="6 characters. Only numbers" data-success=""></span>
          </div>
          <div class="input-field col s12 center-align">
            <a id="rejoindre" class="waves-effect waves-light btn-small purple lighten-1 disabled"
              onClick="joinRoom();">JOIN</a>
          </div>
        
      </div>
      <div class="col s12 l6">
        
          <h5 class="purple-text text-darken-2 center-align">Start a new game</h5>
          <div class="input-field col s12 select">
            <select id="language" required="" aria-required="true" onchange="createChecks();">
              <option value="" disabled selected>Choose a language</option>
              <option value="english">English</option>
              <option value="french">French</option>
              <option value="spanish">Spanish</option>
            </select>
          </div>
          <div class="input-field col s12 center-align">
            <a id="creation" class="waves-effect waves-light btn-small purple disabled"
            onClick="createRoom();">CREATE</a>
          </div>
        
      </div>
    </form>
    </div>

    <!-- Modal Trigger -->
   <!--  <div class="fixed-action-btn">
      <a class="btn-floating btn purple darken-2 modal-trigger z-depth-0" href="#modal1">
        <i class="large material-icons">help_outline</i>
      </a>
    </div> -->

    <!-- Modal Structure -->
    <div id="modal1" class="modal bottom-sheet">
      <div class="modal-content">
        <h5>How to play WhoFakesIt</h5>
        <p>A bunch of text</p>
        <h5>How to add content</h5>
        <p>A bunch of text</p>
      </div>
      <div class="modal-footer">
        <a href="#!" class="modal-close waves-effect waves-green btn-flat">back</a>
      </div>
    </div>

    <!-- Tests -->
    <div id="message"></div>

  </main>

  <footer class="footer purple darken-2">
    <div class="row valign-wrapper">
      <div class="copyright col s12 center-align">
        <a class="font2 grey-text text-lighten-4 modal-trigger" href="#modal1">WhoFakesIt</a>
      </div>
    </div>

  </footer>

  <!-- JQuery -->
  <script src="https://code.jquery.com/jquery-3.3.1.min.js"
    integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>

  <!-- JS Cookie -->
  <script src="https://cdn.jsdelivr.net/npm/js-cookie@2/src/js.cookie.min.js"></script>

  <!-- Materialize -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/js/materialize.min.js"></script>

  <script src="/static/game.js"></script>

  <script>

    $(document).ready(function () {
      $('.modal').modal();
    });
    //var instance = M.Modal.getInstance(elem);

    //Set default nickname
    if (Cookies.get('username')) {
      $("input[id=nickname]").val(Cookies.get('username'));
    }
    
    //Set default language
    if (Cookies.get('language')) {
      $("select[id=language]").val(Cookies.get('language'));
      $("a[id=creation]").removeClass('disabled');
        init("interface");
    }

    var filterN = /^[A-Za-z0-9]{3,}$/;
    var filterR = /^\d{6}$/;

    // Create form filters
    function createChecks() {
      if (filterN.test($("input[id=nickname]").val()) && $("select[id=language]").val !== "") {
        $("a[id=creation]").removeClass('disabled');
        init("interface");
      }
      else {
        $("a[id=creation]").addClass('disabled');
      }
    };

    // Join form filters
    
    $("form").keyup(function () {

      if (filterN.test($("input[id=nickname]").val()) && filterR.test($("input[id=room]").val())) {
        $("a[id=rejoindre]").removeClass('disabled');
        init("interface");
      }
      else {
        $("a[id=rejoindre]").addClass('disabled');
      }   

      createChecks(); 
    });




  </script>

</body>

</html>

<!-- ToDo

- Merge les ecrans owner / player; l'owner etant un joueur
- Interagir avec les JSON sur le serveur, et passer les donnÃ©es en string aux clients directement


-->